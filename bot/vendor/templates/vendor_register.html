<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vendor Registration</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px auto;
      max-width: 700px;
      background-color: #f4f4f4;
      padding: 20px;
      border-radius: 10px;
    }
    h2 {
      text-align: center;
      color: #333;
    }
    form input, form button, form label, textarea {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      font-size: 16px;
      box-sizing: border-box;
    }
    form button {
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
    }
    form button:hover {
      background-color: #218838;
    }
    #map {
      height: 300px;
      width: 100%;
      margin-top: 10px;
    }
    .note {
      text-align: center;
      font-size: 14px;
    }
  </style>
</head>
<body>

  <h2>Vendor Registration</h2>
  <form method="POST" action="/register" enctype="multipart/form-data" id="registrationForm">

    <input type="text" name="name" placeholder="Full Name" required>
    <input type="text" name="username" placeholder="Username" required>
    <input type="email" name="email" placeholder="Email ID" required>
    <input type="password" name="password" placeholder="Password" required>
    <input type="text" name="contact_no" placeholder="Contact Number" required>
    <input type="date" name="dob" required>
    <input type="text" name="store_name" placeholder="Store Name" required>

    <label for="personal_image">Your Photo</label>
    <input type="file" name="personal_image" id="personal_image" accept=".jpg,.jpeg,.png" required>

    <label for="store_image">Store Photo</label>
    <input type="file" name="store_image" id="store_image" accept=".jpg,.jpeg,.png" required>

    <label for="pan_no">PAN Number</label>
    <input type="text" name="pan_no" id="pan_no" placeholder="ABCDE1234F" required 
           pattern="[A-Z]{5}[0-9]{4}[A-Z]{1}" title="Enter valid PAN format e.g. ABCDE1234F">
    <label for="pan_card">PAN Card Upload</label>
    <input type="file" name="pan_card" id="pan_card" accept=".jpg,.jpeg,.png,.pdf" required>

    <label for="aadhar_no">Aadhar Number</label>
    <input type="text" name="aadhar_no" id="aadhar_no" placeholder="12 digit Aadhar Number" required 
           pattern="\d{12}" title="Aadhar must be 12 digits only">
    <label for="aadhar_card">Aadhar Card Upload</label>
    <input type="file" name="aadhar_card" id="aadhar_card" accept=".jpg,.jpeg,.png,.pdf" required>

    <label for="store_since">Store Running From (Date)</label>
    <input type="date" name="store_since" id="store_since" required>

    <label for="store_address">Store Address</label>
    <textarea name="store_address" id="store_address" rows="3" placeholder="XX, YY, ZZ" required></textarea>

    <label>Locate Your Store on Map</label>
    <div id="map"></div>

    <input type="hidden" name="latitude" id="latitude">
    <input type="hidden" name="longitude" id="longitude">

    <input type="hidden" name="timestamp" id="timestamp">
    <input type="hidden" name="device_info" id="device_info">
    <input type="hidden" name="location" id="location">

    <button type="submit">Register</button>
  </form>

  <p class="note">Already registered? <a href="/login">Login Here</a></p>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("timestamp").value = new Date().toISOString();
      document.getElementById("device_info").value = navigator.userAgent;

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          document.getElementById("location").value = `Lat: ${pos.coords.latitude}, Lon: ${pos.coords.longitude}`;
        }, () => {
          document.getElementById("location").value = "Permission denied or unavailable.";
        });
      } else {
        document.getElementById("location").value = "Geolocation not supported.";
      }
    });

    let map, marker;
    function initMap() {
      const defaultLocation = { lat: 28.6139, lng: 77.2090 };
      map = new google.maps.Map(document.getElementById("map"), {
        center: defaultLocation,
        zoom: 12,
      });
      marker = new google.maps.Marker({
        position: defaultLocation,
        map: map,
        draggable: true,
      });
      updateLatLngInputs(defaultLocation);

      marker.addListener("dragend", () => {
        const pos = marker.getPosition();
        updateLatLngInputs({ lat: pos.lat(), lng: pos.lng() });
      });
    }

    function updateLatLngInputs({ lat, lng }) {
      document.getElementById("latitude").value = lat.toFixed(6);
      document.getElementById("longitude").value = lng.toFixed(6);
    }
  </script>

  <!-- Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap" async defer></script>

</body>
</html>
